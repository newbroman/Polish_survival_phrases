<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polish Master - Learning App with Gender Toggle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .app-container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        /* Header with Gender Toggle */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
        }
        
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .app-title {
            font-size: 28px;
            font-weight: 700;
        }
        
        .gender-toggle {
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            padding: 4px;
            display: flex;
            gap: 4px;
        }
        
        .gender-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: rgba(255,255,255,0.7);
            border-radius: 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .gender-btn.active {
            background: white;
            color: #667eea;
        }
        
        .gender-btn:hover:not(.active) {
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .mode-toggle {
            display: flex;
            gap: 10px;
        }
        
        .mode-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.1);
            color: white;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .mode-btn.active {
            background: white;
            color: #667eea;
        }
        
        /* Tier Navigation */
        .tier-nav {
            display: flex;
            background: #f8f9fa;
            overflow-x: auto;
        }
        
        .tier-tab {
            flex: 1;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            min-width: 100px;
        }
        
        .tier-tab.active.foundation { border-color: #9b59b6; background: #f8f5ff; }
        .tier-tab.active.survival { border-color: #27ae60; background: #f0fff4; }
        .tier-tab.active.practical { border-color: #f39c12; background: #fffbf0; }
        .tier-tab.active.advanced { border-color: #3498db; background: #f0f8ff; }
        
        .tier-name {
            font-weight: 600;
            font-size: 13px;
        }
        
        .tier-count {
            font-size: 11px;
            color: #666;
            margin-top: 3px;
        }
        
        /* Flashcard */
        .flashcard-container {
            padding: 40px 30px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .flashcard {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 15px;
            padding: 40px 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
        }
        
        .flashcard:hover {
            transform: translateY(-5px);
        }
        
        .flashcard.flipped {
            background: #f8f9fa;
        }
        
        .phrase-polish {
            font-size: 32px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        
        .phrase-english {
            font-size: 24px;
            color: #666;
            line-height: 1.4;
        }
        
        .gender-indicator {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #667eea;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .gender-info-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            border: 2px solid #667eea;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .gender-info-btn:hover {
            background: #667eea;
            color: white;
        }
        
        /* Gender Variant Modal */
        .gender-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .gender-modal.show {
            display: flex;
        }
        
        .gender-modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .gender-modal h3 {
            margin-bottom: 20px;
            color: #333;
        }
        
        .gender-variant {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .gender-variant-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .gender-variant-text {
            font-size: 20px;
            font-weight: 600;
            color: #667eea;
        }
        
        .close-modal {
            margin-top: 20px;
            padding: 12px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        
        /* Controls */
        .controls {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #e0e0e0;
        }
        
        .progress {
            font-size: 14px;
            color: #666;
        }
        
        .nav-buttons {
            display: flex;
            gap: 10px;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }
        
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        /* Level selector */
        .level-selector {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .level-selector select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }
        
        /* Info box */
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px;
            border-radius: 8px;
        }
        
        .info-box strong {
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div class="app-title">üáµüá± Polish Master</div>
                <div class="gender-toggle">
                    <button class="gender-btn" onclick="setGender('m')">‚ôÇ Male</button>
                    <button class="gender-btn active" onclick="setGender('both')">Both</button>
                    <button class="gender-btn" onclick="setGender('f')">‚ôÄ Female</button>
                </div>
            </div>
            <div class="mode-toggle">
                <button class="mode-btn active" onclick="switchMode('learning')">üìö Learning Mode</button>
                <button class="mode-btn" onclick="switchMode('phrasebook')">üìñ Phrasebook</button>
            </div>
        </div>
        
        <!-- Info Box -->
        <div class="info-box">
            <strong>Gender Toggle:</strong> Polish adjectives and verbs change based on speaker's gender. 
            Select your gender above, or choose "Both" to see all forms while learning.
        </div>
        
        <!-- Tier Navigation -->
        <div class="tier-nav">
            <div class="tier-tab foundation" onclick="switchTier('foundation')">
                <div class="tier-name">üü£ Foundation</div>
                <div class="tier-count">123 items</div>
            </div>
            <div class="tier-tab survival active" onclick="switchTier('survival')">
                <div class="tier-name">üü¢ Survival</div>
                <div class="tier-count">350 phrases</div>
            </div>
            <div class="tier-tab practical" onclick="switchTier('practical')">
                <div class="tier-name">üü° Practical</div>
                <div class="tier-count">700 phrases</div>
            </div>
            <div class="tier-tab advanced" onclick="switchTier('advanced')">
                <div class="tier-name">üîµ Advanced</div>
                <div class="tier-count">625 phrases</div>
            </div>
        </div>
        
        <!-- Level Selector -->
        <div class="level-selector">
            <select id="levelSelect" onchange="loadLevel(this.value)">
                <option value="">Select a level...</option>
            </select>
        </div>
        
        <!-- Flashcard -->
        <div class="flashcard-container">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <button class="gender-info-btn" id="genderInfoBtn" onclick="showGenderInfo(event)" style="display: none;">‚ÑπÔ∏è</button>
                <div id="genderIndicator" class="gender-indicator" style="display: none;"></div>
                <div class="phrase-polish" id="phrasePolish">Select a level to start</div>
                <div class="phrase-english" id="phraseEnglish" style="display: none;"></div>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="controls">
            <div class="progress" id="progress">-</div>
            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn" onclick="prevPhrase()" disabled>‚Üê Previous</button>
                <button class="nav-btn" id="nextBtn" onclick="nextPhrase()" disabled>Next ‚Üí</button>
            </div>
        </div>
        
        <!-- Gender Info Modal -->
        <div class="gender-modal" id="genderModal" onclick="closeGenderModal()">
            <div class="gender-modal-content" onclick="event.stopPropagation()">
                <h3>Gender Variants</h3>
                <div id="genderVariantsContent"></div>
                <button class="close-modal" onclick="closeGenderModal()">Close</button>
            </div>
        </div>
    </div>
    
    <script>
        // State
        let currentGender = localStorage.getItem('polishMasterGender') || 'both';
        let currentMode = 'learning';
        let currentTier = 'survival';
        let currentLevel = null;
        let currentPhrases = [];
        let currentIndex = 0;
        let isFlipped = false;
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setGender(currentGender);
            loadTierLevels();
        });
        
        // Gender toggle
        function setGender(gender) {
            currentGender = gender;
            localStorage.setItem('polishMasterGender', gender);
            
            // Update UI
            document.querySelectorAll('.gender-btn').forEach(btn => btn.classList.remove('active'));
            event?.target?.classList?.add('active') || 
                document.querySelector(`.gender-btn:nth-child(${gender === 'm' ? 1 : gender === 'both' ? 2 : 3})`).classList.add('active');
            
            // Reload current phrase with new gender
            if (currentPhrases.length > 0) {
                displayPhrase();
            }
        }
        
        // Switch tier
        function switchTier(tier) {
            currentTier = tier;
            document.querySelectorAll('.tier-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.tier-tab.${tier}`).classList.add('active');
            loadTierLevels();
        }
        
        // Load levels for current tier
        function loadTierLevels() {
            const tierLevels = {
                'foundation': [0, 0.1],
                'survival': [1, 2, 3, 4, 5],
                'practical': [6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
                'advanced': [16, 17, 18, 19, 20, 21, 22]
            };
            
            const levels = tierLevels[currentTier] || [];
            const select = document.getElementById('levelSelect');
            select.innerHTML = '<option value="">Select a level...</option>';
            
            // Load level metadata
            levels.forEach(async (levelNum) => {
                try {
                    const response = await fetch(`phrases_${levelNum}.json`);
                    const data = await response.json();
                    const option = document.createElement('option');
                    option.value = levelNum;
                    option.textContent = `Level ${levelNum}: ${data.description} (${data.phrases.length})`;
                    select.appendChild(option);
                } catch (e) {
                    console.log(`Level ${levelNum} not found`);
                }
            });
        }
        
        // Load level
        async function loadLevel(levelNum) {
            if (!levelNum) return;
            
            try {
                const response = await fetch(`phrases_${levelNum}.json`);
                const data = await response.json();
                currentLevel = levelNum;
                currentPhrases = data.phrases || [];
                currentIndex = 0;
                isFlipped = false;
                
                displayPhrase();
                updateControls();
            } catch (e) {
                alert(`Error loading level ${levelNum}`);
            }
        }
        
        // Display current phrase with gender handling
        function displayPhrase() {
            if (currentPhrases.length === 0) return;
            
            const phrase = currentPhrases[currentIndex];
            const flashcard = document.getElementById('flashcard');
            const polishText = document.getElementById('phrasePolish');
            const englishText = document.getElementById('phraseEnglish');
            const genderInfoBtn = document.getElementById('genderInfoBtn');
            const genderIndicator = document.getElementById('genderIndicator');
            
            // Get appropriate Polish text based on gender setting
            let displayText = phrase.pl;
            
            if (phrase.gender === 'both' && phrase.variants) {
                if (currentGender === 'm') {
                    displayText = phrase.variants.m;
                    genderIndicator.textContent = '‚ôÇ';
                    genderIndicator.style.display = 'block';
                } else if (currentGender === 'f') {
                    displayText = phrase.variants.f;
                    genderIndicator.textContent = '‚ôÄ';
                    genderIndicator.style.display = 'block';
                } else {
                    // Both - show both forms
                    displayText = `${phrase.variants.m} / ${phrase.variants.f}`;
                    genderIndicator.textContent = '‚ôÇ‚ôÄ';
                    genderIndicator.style.display = 'block';
                }
                
                // Show info button for gendered phrases
                genderInfoBtn.style.display = 'flex';
            } else {
                genderInfoBtn.style.display = 'none';
                genderIndicator.style.display = 'none';
            }
            
            polishText.textContent = displayText;
            englishText.textContent = phrase.en;
            
            // Reset flip state
            if (isFlipped) {
                englishText.style.display = 'block';
                flashcard.classList.add('flipped');
            } else {
                englishText.style.display = 'none';
                flashcard.classList.remove('flipped');
            }
            
            // Update progress
            document.getElementById('progress').textContent = 
                `${currentIndex + 1} / ${currentPhrases.length}`;
        }
        
        // Flip card
        function flipCard() {
            isFlipped = !isFlipped;
            const flashcard = document.getElementById('flashcard');
            const englishText = document.getElementById('phraseEnglish');
            
            if (isFlipped) {
                englishText.style.display = 'block';
                flashcard.classList.add('flipped');
            } else {
                englishText.style.display = 'none';
                flashcard.classList.remove('flipped');
            }
        }
        
        // Show gender info modal
        function showGenderInfo(event) {
            event.stopPropagation();
            
            const phrase = currentPhrases[currentIndex];
            if (!phrase.variants) return;
            
            const modal = document.getElementById('genderModal');
            const content = document.getElementById('genderVariantsContent');
            
            content.innerHTML = `
                <div class="gender-variant">
                    <div class="gender-variant-label">‚ôÇ Masculine (Male speaker)</div>
                    <div class="gender-variant-text">${phrase.variants.m}</div>
                </div>
                <div class="gender-variant">
                    <div class="gender-variant-label">‚ôÄ Feminine (Female speaker)</div>
                    <div class="gender-variant-text">${phrase.variants.f}</div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #fff3cd; border-radius: 8px; font-size: 14px;">
                    <strong>üí° Tip:</strong> In Polish, adjectives and past tense verbs change based on the speaker's gender. 
                    Use the gender toggle above to see your preferred form.
                </div>
            `;
            
            modal.classList.add('show');
        }
        
        // Close modal
        function closeGenderModal() {
            document.getElementById('genderModal').classList.remove('show');
        }
        
        // Navigation
        function nextPhrase() {
            if (currentIndex < currentPhrases.length - 1) {
                currentIndex++;
                isFlipped = false;
                displayPhrase();
                updateControls();
            }
        }
        
        function prevPhrase() {
            if (currentIndex > 0) {
                currentIndex--;
                isFlipped = false;
                displayPhrase();
                updateControls();
            }
        }
        
        function updateControls() {
            document.getElementById('prevBtn').disabled = currentIndex === 0;
            document.getElementById('nextBtn').disabled = currentIndex >= currentPhrases.length - 1;
        }
        
        // Switch mode
        function switchMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (mode === 'phrasebook') {
                window.location.href = 'phrasebook-features.html';
            }
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                e.preventDefault();
                if (!isFlipped) {
                    flipCard();
                } else {
                    nextPhrase();
                }
            } else if (e.key === 'ArrowLeft') {
                e.preventDefault();
                prevPhrase();
            } else if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                e.preventDefault();
                flipCard();
            }
        });
    </script>
</body>
</html>
